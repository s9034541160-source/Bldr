<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cursor MCP Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f0f0f0;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 10px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        button {
            background: #007acc;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #005a9e;
        }
        .log {
            background: #1e1e1e;
            color: #00ff00;
            padding: 15px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <h1>üß™ Cursor MCP Integration Test</h1>
    
    <div class="test-section">
        <h3>üì° –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Cursor MCP</h3>
        <button onclick="testConnection()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ</button>
        <div id="connectionResult"></div>
    </div>
    
    <div class="test-section">
        <h3>üö® –¢–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—à–∏–±–æ–∫ –≤ Cursor</h3>
        <button onclick="sendTestError()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é –æ—à–∏–±–∫—É</button>
        <button onclick="sendJavaScriptError()">JavaScript –æ—à–∏–±–∫–∞</button>
        <button onclick="sendNetworkError()">–°–µ—Ç–µ–≤–∞—è –æ—à–∏–±–∫–∞</button>
    </div>
    
    <div class="test-section">
        <h3>üìä –õ–æ–≥ —Å–æ–±—ã—Ç–∏–π</h3>
        <div class="log" id="eventLog">–ì–æ—Ç–æ–≤ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é...\n</div>
        <button onclick="clearLog()">–û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥</button>
    </div>

    <script>
        let logEntries = [];
        
        function log(message) {
            const timestamp = new Date().toLocaleTimeString();
            const entry = `[${timestamp}] ${message}`;
            logEntries.push(entry);
            
            const logElement = document.getElementById('eventLog');
            logElement.textContent = logEntries.slice(-20).join('\n');
            logElement.scrollTop = logElement.scrollHeight;
        }
        
        function testConnection() {
            log('üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Cursor MCP...');
            
            fetch('http://localhost:3002/cursor/status')
                .then(response => {
                    if (response.ok) {
                        log('‚úÖ Cursor MCP —Å–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω!');
                        document.getElementById('connectionResult').innerHTML = 
                            '<div style="color: green;">‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–æ –∫ Cursor MCP</div>';
                    } else {
                        log('‚ùå –°–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω');
                        document.getElementById('connectionResult').innerHTML = 
                            '<div style="color: red;">‚ùå –°–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω</div>';
                    }
                })
                .catch(error => {
                    log('‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: ' + error.message);
                    document.getElementById('connectionResult').innerHTML = 
                        '<div style="color: red;">‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è</div>';
                });
        }
        
        function sendTestError() {
            log('üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –æ—à–∏–±–∫–∏ –≤ Cursor...');
            
            const errorData = {
                type: 'Test Error',
                message: '–¢–µ—Å—Ç–æ–≤–∞—è –æ—à–∏–±–∫–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ Cursor MCP –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏',
                url: window.location.href,
                timestamp: new Date().toISOString(),
                severity: 'medium',
                source: 'test-page'
            };
            
            fetch('http://localhost:3002/cursor/error', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(errorData)
            })
            .then(response => response.json())
            .then(data => {
                log('‚úÖ –û—à–∏–±–∫–∞ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤ Cursor MCP!');
                log('üìã –û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞: ' + JSON.stringify(data));
            })
            .catch(error => {
                log('‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏: ' + error.message);
            });
        }
        
        function sendJavaScriptError() {
            log('üß™ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è JavaScript –æ—à–∏–±–∫–∏...');
            
            try {
                // –ù–∞–º–µ—Ä–µ–Ω–Ω–æ –≤—ã–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É
                undefinedVariable.someMethod();
            } catch (error) {
                log('‚úÖ JavaScript –æ—à–∏–±–∫–∞ –∑–∞—Ö–≤–∞—á–µ–Ω–∞: ' + error.message);
                
                const errorData = {
                    type: 'JavaScript Error',
                    message: error.message,
                    stack: error.stack,
                    url: window.location.href,
                    timestamp: new Date().toISOString(),
                    severity: 'high'
                };
                
                fetch('http://localhost:3002/cursor/error', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(errorData)
                })
                .then(response => response.json())
                .then(data => {
                    log('‚úÖ JavaScript –æ—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤ Cursor!');
                })
                .catch(err => {
                    log('‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ JS –æ—à–∏–±–∫–∏: ' + err.message);
                });
            }
        }
        
        function sendNetworkError() {
            log('üåê –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ç–µ–≤–æ–π –æ—à–∏–±–∫–∏...');
            
            fetch('http://localhost:3002/nonexistent-endpoint')
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }
                })
                .catch(error => {
                    log('‚úÖ –°–µ—Ç–µ–≤–∞—è –æ—à–∏–±–∫–∞ –∑–∞—Ö–≤–∞—á–µ–Ω–∞: ' + error.message);
                    
                    const errorData = {
                        type: 'Network Error',
                        message: error.message,
                        url: window.location.href,
                        timestamp: new Date().toISOString(),
                        severity: 'medium'
                    };
                    
                    fetch('http://localhost:3002/cursor/error', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(errorData)
                    })
                    .then(response => response.json())
                    .then(data => {
                        log('‚úÖ –°–µ—Ç–µ–≤–∞—è –æ—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤ Cursor!');
                    })
                    .catch(err => {
                        log('‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–µ—Ç–µ–≤–æ–π –æ—à–∏–±–∫–∏: ' + err.message);
                    });
                });
        }
        
        function clearLog() {
            logEntries = [];
            document.getElementById('eventLog').textContent = '–õ–æ–≥ –æ—á–∏—â–µ–Ω...\n';
        }
        
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –æ—à–∏–±–æ–∫
        window.addEventListener('error', (event) => {
            log('üîç –ì–ª–æ–±–∞–ª—å–Ω–∞—è –æ—à–∏–±–∫–∞: ' + event.message);
        });
        
        window.addEventListener('unhandledrejection', (event) => {
            log('üîç Unhandled Promise: ' + event.reason);
        });
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        log('üöÄ Cursor MCP —Ç–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
        log('üìç URL: ' + window.location.href);
    </script>
</body>
</html>

