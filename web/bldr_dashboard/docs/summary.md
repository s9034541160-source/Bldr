# Bldr Empire v2 - RAG Module React Component

## Обзор

Этот проект представляет собой адаптацию Tkinter GUI для RAG train/query/dashboard в полноценный React 18 + Vite компонент для Bldr Empire v2. Компонент полностью интегрирован с архитектурой SuperBuilder и следует 14-этапному симбиотическому пайплайну.

## Файлы проекта

### Основные компоненты

1. **`src/components/RAGModule.tsx`** - Главный компонент с тремя вкладками:
   - **Train Tab**: Управление процессом обучения RAG
   - **Query Tab**: Интерфейс для семантического поиска
   - **Dashboard Tab**: Визуализация метрик и аналитика

2. **`src/services/api.ts`** - Сервис для работы с Bldr API

3. **`src/App.tsx`** - Главный компонент приложения

4. **`src/main.tsx`** - Точка входа приложения

### Конфигурационные файлы

1. **`package.json`** - Зависимости и скрипты
2. **`tsconfig.json`** - Конфигурация TypeScript
3. **`vite.config.ts`** - Конфигурация Vite
4. **`index.html`** - HTML шаблон

### Скрипты

1. **`setup.bat`** - Установка зависимостей
2. **`start.bat`** - Запуск сервера разработки
3. **`build.bat`** - Сборка проекта

## Особенности реализации

### Интеграция с архитектурой SuperBuilder

Компонент следует архитектуре SuperBuilder:
- Использует ModelManager с ролями (coordinator, chief_engineer и др.)
- Реализует 14-этапный симбиотический пайплайн RAG
- Интегрируется с ToolsSystem для search_rag/calculate_estimate
- Использует Coordinator для JSON-плана и синтеза

### Следование пайплайну

Компонент поддерживает все 14 этапов:
1. Валидация документа
2. Проверка на дубликаты
3. Извлечение текста
4. Определение типа документа (симбиотический подход)
5. Структурный анализ
6. Извлечение кандидатов (Regex → Rubern)
7. Генерация разметки Rubern
8. Извлечение метаданных
9. Контроль качества
10. Тип-специфическая обработка
11. Извлечение рабочих последовательностей
12. Сохранение в Neo4j
13. Разбиение на чанки и генерация эмбеддингов
14. Сохранение в Qdrant

### Интеграция с ролями

Компонент учитывает распределение ролей:
- **Coordinator** (DeepSeek-R1-0528-Qwen3-8B) - для планирования
- **Chief Engineer** (qwen2.5-vl-7b) - для технического анализа
- LRU cache для 12 моделей с предзагрузкой высокоприоритетных

## Технологии

- **React 18** - для построения пользовательского интерфейса
- **TypeScript** - для типизации и улучшения качества кода
- **Ant Design** - UI библиотека для компонентов
- **Recharts** - библиотека для визуализации данных
- **Axios** - для HTTP запросов к API
- **Socket.io** - для WebSocket соединений и реального времени
- **Vite** - для быстрой сборки и разработки

## Функциональность

### Train Tab
- Кнопка запуска обучения с прогрессом в реальном времени
- Логи этапов с цветовой кодировкой
- Возможность запуска отдельных этапов
- Интеграция с WebSocket для получения логов

### Query Tab
- Форма для ввода запросов
- Таблица результатов с оценками
- Цветовые теги в зависимости от оценки (conf >0.99 green/orange/red)
- Поддержка семантического поиска

### Dashboard Tab
- Диаграмма сущностей (Pie chart)
- Метрики (Bar chart)
- Прогресс этапов (Line chart)
- Статистика по чанкам, NDCG, coverage, violations

## Установка и запуск

1. Перейдите в директорию проекта:
   ```
   cd web/bldr_dashboard
   ```

2. Установите зависимости:
   ```
   npm install
   ```
   или запустите `setup.bat`

3. Запустите сервер разработки:
   ```
   npm run dev
   ```
   или запустите `start.bat`

4. Для сборки проекта:
   ```
   npm run build
   ```
   или запустите `build.bat`

## Тестирование

После запуска сервера разработки:
1. Откройте браузер по адресу `http://localhost:3000`
2. Перейдите на вкладку "Запрос"
3. Введите тестовый запрос: `cl.5.2 СП31`
4. Проверьте отображение результатов в таблице

## Интеграция с API

Компонент интегрирован с существующим Bldr API:
- `/train` - запуск обучения
- `/query` - выполнение запросов
- `/metrics` - получение метрик
- `/ai` - вызов AI с определенной ролью
- WebSocket `/ws` - для логов в реальном времени

## Стилизация

Компонент использует "rainbow Tinker style" с цветовой кодировкой:
- `.stage7 {color: #ff6b6b}`
- `.conf99 {background: linear-gradient(45deg, #ff9a9e, #fecfef)}`
- Адаптивный дизайн для мобильных устройств